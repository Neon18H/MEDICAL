{% extends 'base.html' %}
{% block content %}
<div class="row">
    <div class="col-lg-3">
        <div class="card mb-3">
            <div class="card-body">
                <h5>Pasos</h5>
                <ol id="step-list" class="small"></ol>
            </div>
        </div>
        <div class="card">
            <div class="card-body">
                <h6>Checklist</h6>
                <ul id="checklist" class="small"></ul>
            </div>
        </div>
    </div>
    <div class="col-lg-6">
        <div class="card">
            <div class="card-body text-center">
                <canvas id="sim-canvas" width="900" height="520" class="w-100 border"></canvas>
            </div>
        </div>
        <div class="mt-3">
            <div class="btn-group" role="group">
                <button class="btn btn-outline-primary" onclick="sendAction('CUT')">CUT</button>
                <button class="btn btn-outline-primary" onclick="sendAction('SUTURE')">SUTURE</button>
                <button class="btn btn-outline-primary" onclick="sendAction('GRAB')">GRAB</button>
                <button class="btn btn-outline-primary" onclick="sendAction('RELEASE')">RELEASE</button>
            </div>
        </div>
    </div>
    <div class="col-lg-3">
        <div class="card mb-3">
            <div class="card-body">
                <h5>Monitor</h5>
                <div>Tiempo: <span id="timer">0</span>s</div>
                <div>Errores: <span id="error-count">0</span></div>
                <div>Progreso: <span id="progress">0%</span></div>
                <button class="btn btn-danger mt-3 w-100" onclick="finishAttempt()">Finalizar</button>
            </div>
        </div>
        <div class="card">
            <div class="card-body">
                <h6>Errores en tiempo real</h6>
                <ul id="error-list" class="small"></ul>
            </div>
        </div>
    </div>
</div>
<script>
    const PROCEDURE = {{ procedure|safe }};
</script>
{% endblock %}
{% block scripts %}
<script src="/static/js/simulator.js"></script>
<script>
    requireAuth('STUDENT');
    initSimulator(PROCEDURE);
</script>
{% endblock %}
